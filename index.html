<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI图片放大 - Waifu2x 专业版 (ONNX)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        
        <div class="controls-panel glass-card">
            <div class="app-header">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <h1>AI图像放大系统</h1>
                <span class="version-badge">V2.3</span>
            </div>
            <div class="status-card glass-card">
                <div id="status">
                    <i class="fas fa-info-circle"></i> 等待上传图片...
                </div>
                
                <div class="action-buttons">
                    <button id="executeBtn" style="display: none;">
                        <i class="fas fa-bolt"></i> 开始处理
                    </button>
                    <button id="downloadBtn" class="download-btn" style="display: none;">
                        <i class="fas fa-download"></i> 下载结果
                    </button>
                </div>
            </div>
            
            
            <div class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <p>拖放图片或点击上传</p>
                    <p class="upload-hint">支持 JPG, PNG, WEBP (最大 10MB)</p>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;">
                </div>
            </div>
            
            <div class="settings-card glass-card">
                <div class="settings-header">
                    <i class="fas fa-cog"></i>
                    <h2>处理设置</h2>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-project-diagram"></i> AI模型架构
                    </label>
                    <div class="select-wrapper">
                        <select id="waifu2x-arch">
                            <option value="cunet">CUNet (高质量)</option>
                            <option value="swin_unet">Swin-Unet (最新)</option>
                        </select>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-paint-brush"></i> 图像风格
                    </label>
                    <div class="select-wrapper">
                        <select id="waifu2x-style">
                            <option value="art">艺术/插画</option>
                            <option value="photo">照片</option>
                        </select>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-filter"></i> 降噪级别
                    </label>
                    <div class="select-wrapper">
                        <select id="waifu2x-noise" class="form-select">
                            <option value="-1">无降噪</option> 
                            <option value="0">等级 0</option> 
                            <option value="1">等级 1</option>
                            <option value="2">等级 2</option>
                            <option value="3">等级 3</option>
                        </select>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-expand"></i> 放大倍数
                    </label>
                    <div class="select-wrapper">
                        <select id="waifu2x-scale">
                            <option value="2">2倍</option>
                            <option value="4">4倍</option>
                            <option value="1">不放大</option>
                        </select>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-memory"></i> 内存策略
                        <span class="value-badge" id="memoryValue">1.0 GB</span>
                    </label>
                    <input type="range" id="memorySlider" min="0" max="3" step="1" value="1">
                    <div class="memory-options">
                        <div class="memory-option" data-value="0">
                            <h4>低内存</h4>
                            <p>512MB (较慢)</p>
                        </div>
                        <div class="memory-option active" data-value="1">
                            <h4>平衡模式</h4>
                            <p>1.0 GB (推荐)</p>
                        </div>
                        <div class="memory-option" data-value="2">
                            <h4>高性能</h4>
                            <p>2.0 GB (快速)</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="settings-card glass-card">
                <div class="settings-header">
                    <i class="fas fa-th-large"></i>
                    <h2>智能分割</h2>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-sliders-h"></i> 分割粒度
                        <span class="value-badge" id="tilingValue">自动</span>
                    </label>
                    <!-- 这个滑块将在图片加载后被动态设置 -->
                    <input type="range" id="tilingSlider" min="0" max="0" value="0" disabled>
                    <div class="slider-info" id="tilingInfo">
                        上传图片后将自动计算最优分割方案。滑动可调整分割块数，块数越多速度越快，但可能增加内存消耗。
                    </div>
                </div>
            </div>
        </div>
        
        <div class="display-panel">
            <div class="image-card glass-card" style="height:50%;">
                <div class="card-header">
                    <h2><i class="fas fa-image"></i> 原始图片</h2>
                    <span class="image-info" id="originalInfo">0×0 • 0 MB</span>
                </div>
                <div class="image-container" id="originalImageBox" style="display: none;">
                    <img id="originalImage" alt="原始图片">
                </div>
            </div>
            
            <div class="image-card glass-card">
                <div class="card-header">
                    <h2><i class="fas fa-magic"></i> 放大结果</h2>
                    <span class="image-info" id="resultInfo">0×0 • 0 MP</span>
                </div>
                <div class="image-container" id="resultContainer" style="display: none;">
                    <div class="preview-container">
                        <canvas id="resultCanvas"></canvas>
                        <div class="preview-overlay" id="previewOverlay">准备就绪</div>
                        <div class="progress-container">
                            <div class="progress-bar" id="progressBar"></div>
                            <div class="progress-text" id="progressText">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 引入 ONNX Runtime Web -->
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.22.0/dist/ort.min.js"></script>
    <script src="main.js"></script>
</body>
</html>